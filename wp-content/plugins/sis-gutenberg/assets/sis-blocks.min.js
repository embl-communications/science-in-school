!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("@wordpress/blocks"),require("react"),require("@wordpress/block-editor"),require("@wordpress/components"),require("@wordpress/data"),require("@wordpress/i18n"),require("@wordpress/hooks")):"function"==typeof define&&define.amd?define(["@wordpress/blocks","react","@wordpress/block-editor","@wordpress/components","@wordpress/data","@wordpress/i18n","@wordpress/hooks"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).wp.blocks,e.React,e.wp.blockEditor,e.wp.components,e.wp.data,e.wp.i18n,e.wp.hooks)}(this,(function(e,t,n,r,o,l,s){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=a(t);const c={renderPrefix:"",renderSuffix:"",postId:0,nonce:""};var u=wp.element.createElement(r.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},wp.element.createElement(r.Path,{d:"M19 7h-1V5h-4v2h-4V5H6v2H5c-1.1 0-2 .9-2 2v10h18V9c0-1.1-.9-2-2-2zm0 10H5V9h14v8z"}),wp.element.createElement(r.Path,{d:"M10.943 16c.522-1.854.972-3.726 1.386-5.58h-1.323a126.482 126.482 0 01-.918 4.383h-.081c-.342-1.44-.657-2.988-.936-4.428l-1.35.09c.414 1.854.873 3.681 1.395 5.535h1.827zm5.161-2.169H14.16V16h-1.332v-5.58h3.636v1.098H14.16v1.296h1.944v1.017z"}));const p=()=>({icon:u,keywords:[l.__("VF"),l.__("Visual Framework"),l.__("EMBL")],attributes:{ver:{type:"string"}},supports:{align:!1,className:!1,customClassName:!1,html:!1},edit:()=>null,save:()=>null}),m=p(),d={...m,name:"sis/info-box-column",title:l.__("SiS Info Box Column"),category:"vf/core",description:l.__("Visual Framework (core)"),parent:["sis/info-box"],supports:{...m.supports,inserter:!1,lightBlockWrapper:!0},attributes:{...m.attributes,span:{type:"integer",default:1}}};function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}d.save=e=>{const{span:t}=e.attributes,r=[];Number.isInteger(t)&&t>1&&r.push(`vf-grid__col--span-${t}`);const o={};return r.length&&(o.className=r.join(" ")),wp.element.createElement("div",o,wp.element.createElement(n.InnerBlocks.Content,null))},d.edit=e=>{const{clientId:s}=e,{span:a}=e.attributes,{updateBlockAttributes:c}=o.useDispatch("core/block-editor"),{hasChildBlocks:u,hasSpanSupport:p,rootClientId:m}=o.useSelect((e=>{const{getBlockName:t,getBlockOrder:n,getBlockRootClientId:r}=e("core/block-editor"),o=r(s);return{rootClientId:o,hasChildBlocks:n(s).length>0,hasSpanSupport:"sis/info-box"===t(o)}}),[s]);t.useEffect((()=>{p||1===a||e.setAttributes({span:1})}),[s]);const d=t.useCallback((t=>{a!==t&&(e.setAttributes({span:t}),c(m,{dirty:Date.now()}))}),[a,s,m]),f={},b=[];return p&&Number.isInteger(a)&&a>1&&b.push(`vf-grid__col--span-${a}`),b.length&&(f.className=b.join(" ")),wp.element.createElement(i.default.Fragment,null,p&&wp.element.createElement(n.InspectorControls,null,wp.element.createElement(r.PanelBody,{title:l.__("Advanced Settings"),initialOpen:!0},wp.element.createElement(r.RangeControl,{label:l.__("Column span"),help:l.__("Columns may be merged to fit."),value:Number.isInteger(a)?a:1,onChange:d,allowReset:!0,step:1,min:1,max:6}))),wp.element.createElement(n.__experimentalBlock.div,f,wp.element.createElement(n.InnerBlocks,{templateLock:!1,renderAppender:u?void 0:()=>wp.element.createElement(n.InnerBlocks.ButtonBlockAppender,null)})))};const b=e=>{const{value:t,min:n,max:o,onChange:s}=e,a={label:l.__("Number of Columns"),className:"components-vf-control"};e.help&&(a.help=e.help);const i=e=>e+n===t;return wp.element.createElement(r.BaseControl,a,wp.element.createElement(r.ButtonGroup,{"aria-label":a.label},Array(o-n+1).fill().map(((e,t)=>wp.element.createElement(r.Button,{key:t,isPrimary:i(t),"aria-pressed":i(t),onClick:()=>s(t+n)},t+n)))))},w=e=>{const t={label:l.__("Type of info box"),className:"components-vf-control"};return e.help&&(t.help=e.help),wp.element.createElement(r.BaseControl,t,wp.element.createElement(r.ButtonGroup,{"aria-label":t.label},wp.element.createElement(r.Button,{key:"infoBox"},"Info box"),wp.element.createElement(r.Button,{key:"safetyMan"},"Safety man")))},g=(t,n,r,o)=>({type:"block",blocks:[t],isMatch:e=>1!==e.placeholder,transform:(t,l)=>{let s=l.map((e=>({attributes:{...e.attributes},innerBlocks:[...e.innerBlocks]})));for(;s.length<r;)s.push({});for(;s.length>o;){const e=s.pop();s[s.length-1].innerBlocks.push(...e.innerBlocks)}return e.createBlock(n,{columns:s.length},s.map((t=>e.createBlock("sis/info-box-column",t.attributes||{},t.innerBlocks||[]))))}}),h=p(),v={...h,name:"sis/info-box",title:l.__("SiS Info box 2"),category:"vf/core",description:l.__("Visual Framework (core)"),supports:{...h.supports,lightBlockWrapper:!0},attributes:{...h.attributes,placeholder:{type:"integer",default:0},columns:{type:"integer",default:0},boxtype:{type:"string",default:"infoBox"},dirty:{type:"integer",default:0}}};function k(e,t){var n,r;if(0===t.length)return e;for(n=0,r=t.length;n<r;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e<0?-2*e:e}function _(e,t,n,r){var o,l=k(k(k(e,n),(o=t,Object.prototype.toString.call(o))),typeof t);if(null===t)return k(l,"null");if(void 0===t)return k(l,"undefined");if("object"==typeof t||"function"==typeof t){if(-1!==r.indexOf(t))return k(l,"[Circular]"+n);r.push(t);var s=function(e,t,n){return Object.keys(t).sort().reduce((function(e,r){return _(e,t[r],r,n)}),e)}(l,t,r);if(!("valueOf"in t)||"function"!=typeof t.valueOf)return s;try{return k(s,String(t.valueOf()))}catch(e){return k(s,"[valueOf exception]"+(e.stack||e.message))}}return k(l,t.toString())}v.save=e=>{const{columns:t,placeholder:r}=e.attributes;if(1===r)return null;const o=`vf-grid sis-information-box sis-information-box--${boxtype} | vf-grid__col-${t}`;return wp.element.createElement("div",{className:o},wp.element.createElement(n.InnerBlocks.Content,null))},v.edit=s=>{const{clientId:a}=s,{dirty:c,columns:u,boxtype:p,placeholder:m}=s.attributes;console.log("boxtype",p),t.useEffect((()=>{0===u&&s.setAttributes({placeholder:1})}),[a]);const{replaceInnerBlocks:d}=o.useDispatch("core/block-editor"),{setColumns:g,updateColumns:h}=o.useSelect((t=>{const{getBlocks:n,getBlockAttributes:r}=t("core/block-editor"),o=e=>{let t=0;return e.forEach((e=>{const{span:n}=e.attributes;Number.isInteger(n)&&n>0?t+=n:t++})),t},l=t=>{s.setAttributes({columns:t,placeholder:0});const r=n(a),l=o(r);t<l&&(e=>{let t=n(a),r=[];for(;t.length>1&&o(t)>e;)r=r.concat(t.pop().innerBlocks);d(t[t.length-1].clientId,r.concat(t[t.length-1].innerBlocks),!1),d(a,n(a).slice(0,t.length),!1)})(t),t>l&&(t=>{const r=n(a);for(;o(r)<t;)r.push(e.createBlock("sis/info-box-column",{},[]));d(a,r,!1)})(t)};return{setColumns:l,updateColumns:()=>{const{columns:e}=r(a);l(e),s.setAttributes({dirty:0})}}}),[a]);t.useEffect((()=>{c>0&&h()}),[c]);const v=e=>wp.element.createElement(b,f({value:u,min:1,max:6,onChange:t.useCallback((e=>g(e)))},e));if(1===m)return wp.element.createElement(n.__experimentalBlock.div,{className:"vf-block vf-block--placeholder"},wp.element.createElement(r.Placeholder,{label:l.__("SiS Info Box"),icon:"admin-generic"},wp.element.createElement(v,null),wp.element.createElement(w,f({value:p},s))));const k=`vf-grid sis-information-box sis-information-box--${p} | vf-grid__col-${u}`,_={"--block-columns":u};return wp.element.createElement(i.default.Fragment,null,wp.element.createElement(n.InspectorControls,null,wp.element.createElement(r.PanelBody,{title:l.__("Advanced Settings"),initialOpen:!0},wp.element.createElement(v,{help:l.__("Content may be reorganised when columns are reduced.")}),wp.element.createElement(w,f({value:p},s)))),wp.element.createElement(n.__experimentalBlock.div,{className:k,style:_},wp.element.createElement(n.InnerBlocks,{allowedBlocks:["sis/info-box-column"],templateLock:"all"})))},v.transforms={from:[g("core/columns","sis/info-box",1,6),g("vf/embl-grid","sis/info-box",1,6)]};const y=e=>function(e,t){for(;e.length<t;)e="0"+e;return e}(_(0,e,"",[]).toString(16),8),E=p(),B={};var x={...E,name:"sis/plugin",title:l.__("Preview"),category:"vf/wp",description:"",attributes:{...E.attributes,ref:{type:"string"}},supports:{...E.supports,inserter:!1,reusable:!1},edit:(e=>{const n={fields:{}};return r=>{const{clientId:o}=r;return t.useEffect((()=>{s.hasAction("vf_plugin_acf_update","vf_plugin")||s.addAction("vf_plugin_acf_update","vf_plugin",(e=>{n.fields[e.name]=e.value,r.setAttributes({__acfUpdate:Date.now()})}))}),[o]),e({...r,transient:{...r.transient||{},...n}})}})((e=>{const[n]=t.useState(acf.uniqid("block_")),[o,l]=t.useState(!0),[s,a]=t.useState(!0),[i,c]=t.useState(""),[u,p]=t.useState(null),m=t.useRef(null),{clientId:d}=e,f=t.useCallback((e=>{const{id:t}=e.data;t&&t.includes(n)&&(clearTimeout(window[`${t}_onMessage`]),window[`${t}_onMessage`]=setTimeout((()=>{window.removeEventListener("message",f),a(!1)}),100))}),[d]);t.useEffect((()=>{a(!0),l(!0),window.removeEventListener("message",f),window.addEventListener("message",f);(async()=>{let t;const r={is_plugin:1,...e.transient.fields},o=y(r);if(B.hasOwnProperty(o))t=await new Promise((e=>setTimeout((()=>{e(B[o])}),1)));else{const l=await wp.ajax.post("acf/ajax/fetch-block",{query:{preview:!0},nonce:acf.get("nonce"),post_id:acf.get("post_id"),block:JSON.stringify({id:n,name:e.attributes.ref,data:r,align:"",mode:"preview"})});l&&l.preview&&(t=l.preview,B[o]=t)}if(t){const e=t.split(/<script[^>]*?>/)[0],n=t.match(/<script[^>]*?>(.*)<\/script>/ms);p(Array.isArray(n)?n[1]:null),c(e),l(!1)}})()}),[d,e.attributes.__acfUpdate]),t.useEffect((()=>{if(!o&&(m.current.innerHTML=i,u)){const e=document.createElement("script");e.type="text/javascript",e.innerHTML=u,m.current.appendChild(e)}}),[o]);const b={className:`vf-block ${e.className}`,"data-ver":e.attributes.ver,"data-name":e.name,"data-editing":!1,"data-loading":s,style:{}};s&&(b.style.minHeight="100px");const w={};return s&&(w.visibility="hidden"),wp.element.createElement("div",b,s&&wp.element.createElement(r.Spinner,null),wp.element.createElement("div",{ref:m,style:w,className:"vf-block__view"}))})),save:()=>null};
/**!
   * VF Gutenberg blocks
   */const{coreOptin:C}=(()=>{const e=window.vfGutenberg||{};for(let[t,n]of Object.entries(c))e.hasOwnProperty(t)||(e[t]=n);return e})();if(1===parseInt(C)){[d,v].forEach((t=>e.registerBlockType(t.name,t)))}e.registerBlockType("sis/plugin",x),window.addEventListener("message",(({data:e})=>{if(e!==Object(e)||!/^vfwp_/.test(e.id))return;const t=document.getElementById(e.id);t&&t.vfActive&&window.requestAnimationFrame((()=>{t.style.height=`${e.height}px`}))}))}));
